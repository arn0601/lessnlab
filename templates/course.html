{% extends "base.html" %}
{% load staticfiles %}
{% load dictionary_extras %}
<!DOCTYPE html>
{% block content %}
{% for course in userCourses %}
<div class="container coursebox" style="width: 100%;">
<div class="row">
	<div class="span4">
        <a class="courseboxtitle" href="/units/?course_id={{ course.id }}" >{{ course.name }}</a>
    </div>
    <div class="span1 offset3" style="text-align: right; width: 142px;">
    	<a href="javascript:void(0)" rel="tooltip" data-placement="bottom" title="View the learning standards this course is aligned to" onClick="getCourseStandardsFromGroup('{{ group.id }}')"><small>View Standards</small></a>
    </div>
    <div class="span1" style="text-align: right; width: 10px;">
    	<a href="?course_id={{ course.id }}&action=Edit"><small>Edit</small></a>
    </div>
    <div class="span1" style="padding-top:3px; width: 28px;">
    	 <a class="close" rel="tooltip" data-placement="right" title="Delete Course" href="?course_id={{ course.id }}&action=Delete"><i class="icon-trash"></i></a>
    </div>
</div>
<div class="row">
	<div class="span3">
		<h5 class="coursesubtitle">Grade {{ course.grade }}, {{ course.subject }}</h5>
	</div>
</div>
<div class="row courseboxsubtext">
    <div class="span2">
    	<p><b>Written By: </b><a href="#">{{fullname}}</a></p> 
    </div>
</div>
<!-- We need to come up with a better way of showing these standards, it should only show one link regardless of the number of standards groups that are synced -zp -->
<div class="row">
	<div class="span10">
        <p><b>Standards Groups in Course</b>
        {% for group in course.standard_grouping.all %}
		<p> <a onClick="getCourseStandardsFromGroup('{{ group.id }}')"> {{ group.subject.value }} Standards, Grade {{ group.grade.value }}  for {{ group.standard_type.value}}:{{ group.state.value }} 
		</a> </p>
	{% endfor %} 
	</p>
	<!-- TODO remove this as a get -->
		<a class="btn btn-success btn-small" type="button" href="/units/?course_id={{ course.id }}">Go To Course</a>
    </div>
</div>
</div> <!-- Course box -->
{% endfor %}

{% if showEditCourse %}
<div class="modal" id="editCourse">
  <div class="modal-header">
    <a class="close" type="button" href="/courses/">x</a>
    <h3>Edit course</h3>
  </div>
  <div class="modal-body">
    <form method="post" action="{% url editCourse %}" name="login_form">
        {% csrf_token %}
        {% for field in editCourseForm %}
        <div class="control-group">
        {{ field.errors.as_text }}
         <label class="control-label">{{ field.label_tag }}</label>
            <div class="controls">
                {{ field }}
            </div>
                </div>
    {% endfor %}
     <p>
	<input type="hidden" value={{ selectedCourse }} name="selectedCourse">
	<button type="submit" class="btn btn-primary">Update</button>
	<a class="btn btn-primary" type="button" href="/courses/">Cancel</a>
      </p>
    </form>
  </div>
</div>
{% endif %}
{% if showDeleteCourse %}
<div class="modal" id="deleteCourse">
  <div class="modal-header">
    <a class="close" type="button" href="/courses/">x</a>
    <h3>Delete course</h3>
  </div>
  <div class="modal-body">
    <form method="post" action="{% url deleteCourse %}" name="login_form">
        {% csrf_token %}
        {% for field in deleteCourseForm %}
        <div class="control-group">
         <label class="control-label">{{ field.label_tag }}</label>
            <div class="controls">
                {{ field }}
            </div>
                </div>
    {% endfor %}
     Are you sure you want to delete the course?
<p>
     <p><button type="submit" class="btn btn-primary">Yes</button>
        <a class="btn btn-primary" type="button" href="/courses/">No</a>
      </p>
    </form>
  </div>
</div>
{% endif %}
{% if addCourseSecondStep %}
<div class="modal" id="second">
  <div class="modal-header">
    <a class="close" type="button" href="/courses/">x</a>
    <h3>Synced standards to course</h3>
  </div>
  <div class="modal-body">
        We have synced a set of standards based on criteria from your Course
	{% for group in groupsAdded %}
	<table class="table table-striped table-bordered">

	<thead> <tr> <th> # </th> <th> Content </th> </tr> </thead>
		{% for standard in groupsAdded|access:group %}
			<tr><td>{{ standard.numbering }} </td> <td> <a href="/standard/?standard_id={{ standard.id }}">{{ standard.description }} </a> </td> </tr>
		{% endfor %}
	</table>
        {% endfor %}
	<a class="btn btn-primary" type="button" href="/courses/">OK</a>
      </p>
    </form>
  </div>
</div>
{% endif %}

{% if showGroupStandards %}
<div class="modal" id="deleteCourse">
  <div class="modal-header">
    <a class="close" type="button" href="/courses/">x</a>
    <h3>{{ selectedGroup.name }}</h3>
    <h4>This group has been synced based on class parameters</h4>
  </div>
  <div class="modal-body">
	<table class="table table-striped table-bordered">

	<thead> <tr> <th> # </th> <th> Content </th> </tr> </thead>
        {% for standard in groupStandards %}
        
		<tr><td>{{ standard.numbering }} </td> <td> <a href="/standard/?standard_id={{ standard.id }}">{{ standard.description }} </a> </td> </tr>
    {% endfor %}
	</table>

  </div>
</div>
{% endif %}


<script type="text/javascript"> <!-- scroll jquery -->
	function getCourseStandardsFromGroup(id){

		var f = document.createElement("form");
		f.setAttribute('method',"post");
		f.setAttribute('action',"{% url LessonPlanner.views.getStandardsFromGroup %}");
		var i = document.createElement("input");
		i.setAttribute('type',"hidden");
		i.setAttribute('value', id );
		i.setAttribute('name',"group_id");
		f.appendChild(i);
		document.body.appendChild(f);
		f.submit();
	}
</script>

{% endblock %}
