{% extends "base-3col.html" %}
{% load staticfiles %}

<!DOCTYPE html>
{% block content %}

<!-- Middle column main content -->

{% for unit in userUnits %}
	<div class="noborderunitbox" id="{{ unit.id }}">
	<p><a href="/lessons/?unit_id={{ unit.id }}"><h4>{{ unit.name }}</h4></a></p>
	  
		<p><b>Description:</b>{{ unit.description }}</p>
		{% if unit.parent_unit %} <p><b>Unit derived from</b>{{ unit.parent_unit.name }}</p>{% endif %}
		<p><b>Start Date:</b>{{ unit.start_date }}</p>
		<p><b>Expected End Date:</b>{{ unit.end_date }}</p>
		<p><b>Standards for this Unit: </b> 
	<br>	{% for standard in unit.standards.all %}
			{{ standard.description }}<br>
		{% endfor %}
	<br>
	<a class="btn btn-primary btn-small" type="button" href="?unit_id={{ unit.id }}&action=Edit">Edit</a>
        <a class="btn btn-primary btn-small" type="button" href="?unit_id={{ unit.id }}&action=Delete">Delete</a>	
	<a class="btn btn-primary btn-small" type="button" onClick="requestUnitStandards('{{ unit.id }}')" >Add Standards</a>
</div>
{% endfor %}
{% endblock %}
<!-- right nav -->
{% block rightnav %}
	<div class="row-fluid">
		<div class="span12 rightnavsubheader">
			<h4>Course Units</h4>
		</div>
	</div>
	<div class="row-fluid">
		<div class="span12">
			{% if userUnits|length == 0 %}
			<div class="alert alert-info">No units created yet</div>
			{% endif %}
			<ul>
				{% for unit in userUnits %}
				<li><a href="/lessons/?unit_id={{ unit.id }}" onclick="goToByScroll('u1')">{{ unit.name }}</a></li>
				{% endfor %}
				<a href="#addUnit" data-toggle="modal"><small><i class="icon-plus"></i>Add Unit</small></a></li>
			</ul>
			</div>
		</div>
	</div>
{% if showEditUnit %}
<div class="modal" id="editUnit">
  <div class="modal-header">
    <a class="close" type="button" href="/units/?course_id={{ course_id }}">x</a>
    <h3>Edit Unit</h3>
  </div>
  <div class="modal-body">
    <form method="post" action="{% url editUnit %}" name="login_form">
        {% csrf_token %}
        {% for field in editUnitForm %}
        <div class="control-group">
        {{ field.errors.as_text }}
         <label class="control-label">{{ field.label_tag }}</label>
            <div class="controls">
                {{ field }}
            </div>
                </div>
    {% endfor %}
	 
    <p>
	<input type="hidden" value={{ selectedUnit }} name="selectedUnit">
	<button type="submit" class="btn btn-primary">Update</button>
        <a class="btn btn-primary" type="button" href="/units/?course_id={{ course_id }}">Cancel</a>
      </p>
    </form>
  </div>
</div>
{% endif %}
{% if showDeleteUnit %}
<div class="modal" id="deleteUnit">
  <div class="modal-header">
    <a class="close" type="button" href="/units/?course_id={{ course_id }}">x</a>
    <h3>Delete unit</h3>
  </div>
  <div class="modal-body">
    <form method="post" action="{% url deleteUnit %}" name="login_form">
        {% csrf_token %}
        {% for field in deleteUnitForm %}
        <div class="control-group">
         <label class="control-label">{{ field.label_tag }}</label>
            <div class="controls">
                {{ field }}
            </div>
                </div>
    {% endfor %}
     Are you sure you want to delete the unit?
<p>
     <p><button type="submit" class="btn btn-primary">Yes</button>
        <a class="btn btn-primary" type="button" href="/units/?course_id={{ course_id }}">No</a>
      </p>
    </form>
  </div>
</div>
{% endif %}

{% if addingUnitStandards %}
<div class="modal" id="addingStandards">
  <div class="modal-header">
    <a class="close" type="button" href="/courses/">x</a>
    <h3>Add standards to unit</h3>
  </div>
  <div class="modal-body">
    <form method="post" action="{% url addUnitStandards %}" name="add_unit_standards">
        {% csrf_token %}
        {% for field in unitStandardsForm %}
        <div class="control-group">
         <label class="control-label">{{ field.label_tag }}</label>
            <div class="controls">
                {{ field }}
            </div>
                </div>
    {% endfor %}
     
     <p><button type="submit" class="btn btn-primary">Submit</button>
        <a class="btn btn-primary" type="button" href="/courses/">Cancel</a>
      </p>
    </form>
  </div>
</div>
{% endif %}
<script type="text/javascript"> <!-- scroll jquery -->
	function requestUnitStandards(id){

		var f = document.createElement("form");
		f.setAttribute('method',"post");
		f.setAttribute('action',"{% url LessonPlanner.views.requestUnitStandards %}");
		var i = document.createElement("input");
		i.setAttribute('type',"hidden");
		i.setAttribute('value', id );
		i.setAttribute('name',"unit_id");
		f.appendChild(i);
		document.body.appendChild(f);
		f.submit();
	}
</script>
{% endblock %}
