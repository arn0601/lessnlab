{% extends "base-3col.html" %}
{% load staticfiles %}

<!DOCTYPE html>
{% block content %}

<!-- Middle column main content -->
{% if userUnits|length == 0 %}
<div class="container coursebox nounitlessonalert" style="width: 100%;">
		<p>You haven't added any units to this {{unit.course.name}} course yet. Why don't you <a href="#addUnit" data-toggle="modal">add one.</a></p>
</div>
	
{% else %} 	
{% for unit in userUnits %}
<div class="container coursebox" style="width: 100%;">
<div class="row">
	<div class="span2">
        <a class="courseboxtitle" href="/lessons/?unit_id={{ unit.id }}" >{{ unit.name }}</a>
    </div>
    <div class="span1 offset2" style="text-align: right; width: 142px;">
    	<a href="#" rel="tooltip" data-placement="bottom" title="Add the course standards this unit is aligned to" onClick="requestUnitStandards('{{ unit.id }}')')"><small>Add Standards</small></a>
    </div>
    <div class="span1" style="text-align: right; width: 10px;">
    	<a href="?unit_id={{ unit.id }}&action=Edit"><small>Edit</small></a>
    </div>
    <div class="span1" style="padding-top:3px; width: 28px;">
    	 <a class="close" rel="tooltip" data-placement="right" title="Delete Unit" href="?unit_id={{ unit.id }}&action=Delete"><i class="icon-trash"></i></a>
    </div>
</div>
<div class="row">
	<div class="span4">
		<h5 class="coursesubtitle">In {{unit.course.name}}</h5>
	</div>
</div>
<div class="row courseboxsubtext">
    <div class="span2">
    	<p><b>Created By: </b><a href="#">{{fullname}}</a></p><!-- this should link to a public profile view of the user -->
    </div>
    <div class="span2">
    	<p><b>Starts: </b>{{unit.start_date}}</p>
    </div>
    <div class="span2">
    	<p><b>Ends: </b>{{unit.end_date}}</p>
    </div>
</div>
<div class="row">
	<div class="span10">
		<p>
		{{ unit.description }}
		 </p>
	<!-- TODO remove this as a get -->
		<a class="btn btn-success btn-small" type="button" href="/lessons/?unit_id={{ unit.id }}">Go To Unit</a>
    </div>
</div>
</div> 
{% endif %}
<!-- unit box -->
	<!-- <div class="coursebox" id="{{ unit.id }}">
	<p><a href="/lessons/?unit_id={{ unit.id }}"><h4>{{ unit.name }}</h4></a></p>
	  
		<p><b>Description:</b>{{ unit.description }}</p>
		{% if unit.parent_unit %} <p><b>Unit derived from</b>{{ unit.parent_unit.name }}</p>{% endif %}
		<p><b>Start Date:</b>{{ unit.start_date }}</p>
		<p><b>Expected End Date:</b>{{ unit.end_date }}</p>
		<p><b>Standards for this Unit: </b> 
	<br>	{% for standard in unit.standards.all %}
			{{ standard.description }}<br>
		{% endfor %}
	<br>
	<a class="btn btn-primary btn-small" type="button" href="?unit_id={{ unit.id }}&action=Edit">Edit</a>
        <a class="btn btn-primary btn-small" type="button" href="?unit_id={{ unit.id }}&action=Delete">Delete</a>	
	<a class="btn btn-primary btn-small" type="button" onClick="requestUnitStandards('{{ unit.id }}')" >Add Standards</a>
</div> -->
{% endfor %}
{% endblock %}
<!-- right nav -->
{% block rightnav %}
	<!-- <div class="row">
		<div class="span2">
			<h4>{{ course.name}} Units</h4>
		</div>
	</div> -->
	
	<!--  RIGHT HAND NAVIGATION - This generates the right hand side naviation on the units page. Code block shows 
	a prompt to add a unit in the course if no units are present, and otherwise shows a menu 
	of the units that are currently in the course. -->
	
	<div class="row">
		<div class="span3 nocontenttext">
			<ul class="nav nav-list">
				<li class="nav-header">{{course.name}} Units</li>
				{% if userUnits|length == 0 %}
					<li>No units yet? <a href="#addUnit" data-toggle="modal">Add one.</a></li>
				{% else %}
					{% for unit in userUnits %}
					<li><a href="/lessons/?unit_id={{ unit.id }}" onclick="goToByScroll('u1')">{{ unit.name }}</a></li>
					{% endfor %}
					<li><a href="#addUnit" data-toggle="modal"><i class="icon-plus"></i>Add Unit</a></li>
				{% endif %}
				</ul>
			</div>
		</div>
{% if showEditUnit %}
<div class="modal" id="editUnit">
  <div class="modal-header">
    <a class="close" type="button" href="/units/?course_id={{ course_id }}">x</a>
    <h3>Edit Unit</h3>
  </div>
  <div class="modal-body">
    <form method="post" action="{% url editUnit %}" name="login_form">
        {% csrf_token %}
        {% for field in editUnitForm %}
        <div class="control-group">
        {{ field.errors.as_text }}
         <label class="control-label">{{ field.label_tag }}</label>
            <div class="controls">
                {{ field }}
            </div>
                </div>
    {% endfor %}
	 
    <p>
	<input type="hidden" value={{ selectedUnit }} name="selectedUnit">
	<button type="submit" class="btn btn-primary">Update</button>
        <a class="btn btn-primary" type="button" href="/units/?course_id={{ course_id }}">Cancel</a>
      </p>
    </form>
  </div>
</div>
{% endif %}
{% if showDeleteUnit %}
<div class="modal" id="deleteUnit">
  <div class="modal-header">
    <a class="close" type="button" href="/units/?course_id={{ course_id }}">x</a>
    <h3>Delete unit</h3>
  </div>
  <div class="modal-body">
    <form method="post" action="{% url deleteUnit %}" name="login_form">
        {% csrf_token %}
        {% for field in deleteUnitForm %}
        <div class="control-group">
         <label class="control-label">{{ field.label_tag }}</label>
            <div class="controls">
                {{ field }}
            </div>
                </div>
    {% endfor %}
     Are you sure you want to delete the unit?
<p>
     <p><button type="submit" class="btn btn-primary">Yes</button>
        <a class="btn btn-primary" type="button" href="/units/?course_id={{ course_id }}">No</a>
      </p>
    </form>
  </div>
</div>
{% endif %}

{% if addingUnitStandards %}
<div class="modal" id="addingStandards">
  <div class="modal-header">
    <a class="close" type="button" href="/courses/">x</a>
    <h3>Add standards to unit</h3>
  </div>
  <div class="modal-body">
    <form method="post" action="{% url addUnitStandards %}" name="add_unit_standards">
        {% csrf_token %}
        {% for field in unitStandardsForm %}
        <div class="control-group">
         <label class="control-label">{{ field.label_tag }}</label>
            <div class="controls">
                {{ field }}
            </div>
                </div>
    {% endfor %}
     
     <p><button type="submit" class="btn btn-primary">Submit</button>
        <a class="btn btn-primary" type="button" href="/courses/">Cancel</a>
      </p>
    </form>
  </div>
</div>
{% endif %}
<script type="text/javascript"> <!-- scroll jquery -->
	function requestUnitStandards(id){

		var f = document.createElement("form");
		f.setAttribute('method',"post");
		f.setAttribute('action',"{% url LessonPlanner.views.requestUnitStandards %}");
		var i = document.createElement("input");
		i.setAttribute('type',"hidden");
		i.setAttribute('value', id );
		i.setAttribute('name',"unit_id");
		f.appendChild(i);
		document.body.appendChild(f);
		f.submit();
	}
</script>
{% endblock %}
